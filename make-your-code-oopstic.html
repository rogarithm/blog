<p>객체지향적으로 코드를 짜려면 어떻게 해야하는 걸까?</p>
<p>뭘 객체로 만들어야 할까?</p>
<p>어떻게 객체를 만들까?</p>
<p>이 연산은 어떤 객체의 책임일까?</p>
<p>object oriented. 자주 듣는 단어지만 정작 그 뜻이 무엇인지, 어떤 특징을 가지는 코드를 객체지향적이라고 하는지 모른 채로 코드를 짰다.</p>
<p>solid 원칙이나 상속, 다형성, 캡슐화, 추상화 등 객체지향의 특징을 공부하기도 했지만, 좀처럼 와닿지 않았다. 공부했던 책에서 든 예는 너무 추상적이거나 단순해서 어떤 이야기를 하려는 건지 이해하지 못했다.</p>
<p>이러한 이해의 부족은 내가 짜는 코드에 그대로 드러났다. 한 번 자바로 스프링 기반 웹 애플리케이션의 백엔드 API를 만들 때, 의존 객체를 만들어 분리하고, 이런 의존 관계 설정을 스프링 애플리케이션 컨텍스트가 하도록 해서 유연성을 높이긴 했다. 하지만 의도적이었다기보다는 으레 쓰는 형식에 맞춰 만든 것에 가깝다고 봐야할 것 같다.</p>
<p>이런 경험을 통해 객체 지향 언어를 쓰고 있지만, 객체 지향이라는 패러다임에 맞는 코드를 어떻게 짜는지 모른다는 것을 깨달았다.</p>
<p>언어에서 제공하는 기능을 쓰려면 그 언어가 가진 패러다임을 잘 이해하고 쓰는 게 필요하지 않을까 생각했다.</p>
<p>객체지향에 대해 더 잘 알고 싶어졌다. 전에 사놓은 책 중에 조영호님이 쓴 <객체지향의 사실과 오해>와 <오브젝트>가 궁금증을 해결하기에 알맞아 보였다. 하지만 막상 읽어봤을 때, <오브젝트> 책은 이해하기 다소 어려웠고, <객체지향의 사실과 오해>를 꼼꼼히 읽어보기로 했다.</p>
<p>나는 예를 통해 더 잘 이해하는 편이다. 다 읽고 나서 어떤 이야기를 하는지 대충은 알아들은 것 같았지만, 실제로 코드를 짤 때도 그럴까? 이미 여러 번, 책을 읽고 이해했어도 막상 하려고 하면 아무것도 못하는 경우를 많이 경험했기 때문에, 실제로 만들어볼만한 예를 가지고 프로젝트를 하나 만들어보기로 했다. 프로젝트 주제를 결정할 때, 내가 잘 알고있는 주제를 선정했다. 도메인을 잘 알고 있으면 만들기 더 수월하지 않을까 하는 생각이 들었기 때문이다.</p>
<p>음악 도메인을 가지고 프로그램을 만들어보기로 했다. 개인적으로 기타 치는 것을 좋아해서 듣기 좋은 곡이 있으면 커버하고는 하는데, 이런 커버 과정에서 프로그램이 도와줄 수 있는 부분을 생각해낼 수 있었다. 어떤 도메인과 연관된 프로그램을 만들면 그 도메인과 관련된 객체를 정의하고, 그 객체들 사이의 관계를 생각해보는 과정에 도움이 될 것 같았다.</p>
<p>프로그램을 만들면서 느끼고 깨달은 점들이 있다.</p>
<p>코드를 보는 방식이 바뀌었다</p>
<p>다음과 같은 코드를 보자.</p>
<p>Door door = new Door();</p>
<p>door.open();</p>
<p>전에는 이런 코드를 "door라는 Door의 인스턴스에 open이라는 메서드를 호출한다" 고 이해했다.</p>
<p>틀린 말은 아니지만, 더 객체지향적으로 이야기할 수 있다.</p>
<p>door는 Door 타입의 역할을 갖는 객체다. 이 객체는 open이라는 메시지를 수신했을 때 그 메시지를 처리할 수 있어야 할 책임이 있다.</p>
<p>door.open()은 누군가 door에게 open이라는 연산을 수행해줄 것을 요청하는 것으로 볼 수 있다.</p>
<p>더 일상적인 문체로 말하자면, "저기, door님, 열어주시겠어요(open)?" 와 같이 볼 수 있는 것이다.</p>
<p>각 객체의 행위는 그 객체가 다른 객체에게 메시지를 보내고, 다른 객체로부터 받은 메시지에 대한 응답으로 결과를 건네는 것으로 정의된다.</p>
<p>범용적인 타입 대신 도메인 객체로 바꾸기</p>
<p>구현하다보면 String 타입 변수이지만 서로 다른 역할을 갖는 상황이 자주 생겼다. 이런 상황을 자주 보다보니, 그리고 확실한 도메인이 있었기에 '여러 String 타입 변수마다 그 역할에 맞는 타입을 새로 정의해야 하는 것 아닐까?' 하는 생각을 하게 되었다. 하지만 타입을 정의한 다음에는? 기존 코드는 어떤 식으로 바꾸어야 할까 라는 고민이 생겼다.</p>
<p> equals, hashcode 구현</p>
<p>책임 다른 객체에 위임하기</p>
<p> 로직 대부분이 다른 객체의 메서드나 필드 호출로 이루어져 있다면, 굳이 그 객체가 로직 전체를 담당하도록 하지 않을 이유는 무엇인가?</p>
<p>책임을 생각한다는 건 무슨 말인가?</p>
<p> 클래스는 각자가 맡는 역할이 있다. Calculator라는 클래스에 add()라는 메서드가 정의되어 있다면, 어떤 클라이언트가 Calaulator의 인스턴스에 add()를 호출할 것이다. Calculator가 두 숫자를 더하는 책임을 가지고 있기 때문에, 다른 인스턴스에서 Calculator에 부탁하는 것이다.</p>
<p> 프로그램을 만들다보니 클래스를 만들고, 메서드를 만들 당시에는 잘 알지 못했지만 시간이 지나고 메서드가 쓰이는 곳을 살펴보니 그 메서드의 연산을 가지고 있는(책임지는) 것이 더 어울리는 클래스를 발견하게 되었다. 적절한 책임을 생각한다는 건 이런 것이다.</p>
<p> 이전까지는 calculator.add(x, y)를 어떤 연산을 수행하는 것으로 생각했지만, 이런 경험을 하고 나서부터는 (연산을 책임질 객체).(요청할 연산)(객체에게 전달해줄 정보) 로 보이게 되었다.</p>
<p>이후에 어떻게 바뀌었나?</p>
<p> 코드를 보는 눈이 많이 바뀌었다. 로직 구현 이후에 코드를 어떻게 다듬어나갈지 생각할 도구가 생겼다. 이 연산은 어떤 객체에 요청하는 게 나을까? 라던지, 이 데이터들은 객체로 보는 게 낫겠는데? 하는 생각을 자연스럽게 할 수 있게 되었다.</p>
<p>도메인적으로 생각하지 않더라도 책임을 나눌 수 있다</p>
<p> 음악이라는 특정 도메인과 관련한 프로그램을 만든 것은 "이미 있는 도메인이기 때문에" 어떤 연산을 정의할 때 그 책임이 어디인지 명확하게 알 수 있지 않을까 하는 생각에서였다. 하지만 이런 도메인에 속하지 않았더라도 책임을 나눌 수 있다. 내가 만든 프로그램에서만 해도 중심 도메인과 관련 없는 파일 처리나 문자열 처리 연산이 많이 있고, 이런 연산을 처리할 객체도 여러 가지가 있다. 이런 연산도 어느 한 곳에 들어가는 것이 아니라 더 괜찮은 위치(책임)를 고민할 수 있고, 위치를 바꾸는 등 리팩토링할 수 있었다.</p>
<p>코드는 변한다</p>
<p>조영호 님의 책에서 말하는 테스트 주도 개발은 일단 일찍 설계하되 테스트를 만들어서 설계 변경 시 생길 수 있는 문제를 방지하라는 것이었다. 나도 더 괜찮은 설계를 고민하다가 시간을 많이 소모한 적이 있었다. 바로 해결할 수 있는 다른 문제도 많은데! 변화를 수용할 수 있도록 만들어 놓았다면, 지금 바로 완벽한 설계를 만들지 않더라도(그런 건 없다고 생각하지만) 더 나은 설계가 떠올랐을 때 바꿀 수 있다.</p>