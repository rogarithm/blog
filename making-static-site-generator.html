<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="./css/main.css" type="text/css" media="screen" />
	</head>
	<body>
		<div class="site">
			<div class="title">
			</div>
			<h2> xxx</h2>
<p>
  jekyll을 써서 블로그를 만들었다. 내가 좋아하는 루비 언어로 짰고, 익숙한 커맨드라인 환경에서 작업할 수 있는 점이 좋았다. 하지만 잊을만하면 빌드에 문제가 생겼다. 모종의 이유로 낮은 버전의 루비를 썼는데, 이에 맞춰 jekyll도 낮은 버전을 쓰다 보니 생기는 라이브러리나 플러그인 호환성 문제였다. 비슷한 문제와 해결책을 찾을 수 있는 경우는 별 탈 없이 넘어갈 수 있었지만, 간단하게 해결할 수 없는 건 해결 가능한지 확실히 모른 채 의존 라이브러리나 소스 레벨까지 파고들면서 문제 해결에 시간을 쏟아야 하곤 했다.
</p>
<p>
  그다지 생산적이지 않은 노력을 블로그 관리에 쏟아붓고 나서 나는 이 문제를 타개할 방법을 고민했다. 블로그를 빌드할 때 생기는 문제를 해결할 시간에 블로그 글을 어떻게 쓸지 고민하고 싶었기 때문이다. 당시 여러 블로그 플랫폼을 조사해 보고서 고른 게 jekyll이었기에 다른 플랫폼으로 바꾸기도 애매했다. 생각해 보니 문제가 생기는 건 대부분 jekyll 소스의 복잡도가 내가 감당할 수 없는 수준이기 때문이었다. jekyll 소스를 이루는 루비 언어와 각종 의존 라이브러리에 대해 깊게 이해한다면 어떤 문제가 생기더라도 적절한 시간 내에 해결할 수 있을지 모르지만, 그러기엔 내 실력이 모자랐기에 현실적인 해결책이 되지 못했다. 대신 내가 필요한 만큼의 기능만 제공하는 단순한 블로그를 직접 만들기로 했다. 내가 감당할 수 있는 복잡도의 소스라면, 어떤 문제가 생겼을 때 그 문제의 원인을 찾아내기도, 해결책을 알아내기도 수월할 것으로 판단했기 때문이다.
</p>
<p>
  jekyll 초기 버전을 기준으로 삼아 내 요구 사항에 맞춰 만들기로 결정했다. jekyll의 git 커밋 기록을 뒤져서 찾아낸 초기 버전의 소스는, 다른 사람이 짜서 구조를 빠르게 파악하기는 어려웠지만, 커밋이 비교적 잘게 쪼개져 있고 커밋 메시지도 나름 친절하게 적혀있어 변화 과정을 파악하기 수월했기 때문이다. 내가 쓸 수 있는 언어 중 하나인 루비로 이루어진 소스인 점도 이유였다.
</p>
<h2> xxx</h2>
<p>
  만들기를 시작할 때만 해도, 어떤 것부터 시작해야 할지 도무지 감이 잡히지 않았다. jekyll의 저자는 블로그 생성이라는 비즈니스 로직을 어떻게 생각하는지가 궁금했고, 블로그 소프트웨어는 어떤 걸 할 수 있어야 하는지 알고 싶었다. 커밋 기록을 따라가면서 코드가 어떻게 바뀌었는지, 어떤 객체를 구현했고, 객체들이 서로 어떤 메시지를 주고받는지 살펴봤다.
</p>
<p>
  소스를 보면서 내가 이해한 블로그 생성기는 이런 식의 구조를 갖고 동작하는 소프트웨어다.
</p>
<ul>
  <li>site 객체는 블로그를 만드는 데 필요한 모든 정보를 가지고 블로그를 만들 줄 알고 있다.</li>
  <li>작성한 블로그 글인 마크다운 파일 각각은 post 객체로 표현된다. post 객체는 자신이 갖고 있는 마크다운 파일을 html 포맷으로 변환할 줄 알고 있다.</li>
  <li>site 객체는 블로그의 인덱스 페이지를 만들고, post 객체에 요청해 결과적으로 만들어질 블로그 글 html 파일을 생성해 내고, css, 폰트 등 블로그의 스타일과 뼈대를 설정할 때 쓰일 정보를 가져와 적용한다.</li>
</ul>
<p>
  블로그 생성기가 어떤 식으로 돌아가는지 이해한 후에도 할 일이 많이 남아있었다. 실제로 써먹을 정도가 되려면 지엽적인 부분까지도 구현해서 모든 부품이 짜맞춰져 돌아갈 수 있는 상태로 만들어야 했기 때문이다. 이런 작업 중 대부분은 jekyll 초기 버전을 참고해 금방 구현했다. 이를테면 html로 변환한 블로그 글에 html 템플릿을 적용할 수 있게 하는 작업이나 각 페이지에 스타일, 폰트 적용하는 작업이 그랬다.
</p>
<p>
  반면 직접 만들기로 한 부분 중엔 금방은커녕 지금까지도 틈틈이 개선 중인 있는 작업이 있다. 하나는 메타 데이터 입력 및 사용하는 로직 만드는 작업인데, 메타 데이터 처리는 단순한 문자열 처리로 수렴해서 코드 정리와 관련한 고민(해당 로직을 어디에 둘지, 분기문을 어떻게 하면 더 깔끔하게 정리할 수 있을지와 같은)을 제외하면 간단하게 끝낼 수 있는 작업이었다. 반면 마크다운을 html로 변환하는 건 블로그 생성기를 만드는 작업 자체보다 오랜 시간이 걸렸고, 생각했던 것보다 어려운 문제였다. 마크다운 변환은, 그 기저에 깔린 이론을 이해하는 것부터 난관이었을 만큼, 지금까지 만나 본 문제 중에 가장 오랜 시간이 걸렸다. 이런 결정을 내리게 된 이유는 단순했다. 글을 작성할 때 쓰는 마크다운 문법이 그렇게 많지도 않고, 메타데이터 역시 마찬가지였기 때문이다.
</p>
<h2> xxx</h2>
<p>
  블로그 생성기의 완성도가 어느 정도 수준을 넘어서면서, 실제 데이터를 어디에 두고, 어떻게 버전 관리할지 고민하게 되었다. 비록 개인 용도이지만 쓰려고 만들었기 때문에, 프로그램을 사용하면서 새로운 요구 사항이 생기거나 오류가 발생하면 고쳐야 할 게 예상되었다. 글 역시 수정을 거듭하며 다듬어나가고, 그러면 블로그 생성기와 마크다운 포맷 글을 가지고 만드는 블로그 소스도 덩달아 변한다. 블로그 빌드 과정에서 세 요소는 서로 연관되지만, 서로 다른 이유로 변경되기 때문에 각 요소를 서로 다른 공간에 저장해서 독립적으로 버전 관리해야겠다고 생각했다. 그에 더해 번거롭지 않게 블로그를 빌드할 수 있었으면 했다.
</p>
<p>
  이런 이유로 서로 다른 변경 기록을 가질만한 요소를 어떻게 구분하고, 어떻게 서로 이을 것인지 고민했다. 심볼릭 링크는 생각해 낸 가장 간단한 방법이었다. 비록 링크로 연결된 디렉토리 경로가 드러나긴 하지만, 심볼릭 링크로 두 디렉토리(블로그 생성기와 마크다운 포맷 파일, 블로그 생성기와 생성된 블로그)를 연결하고 나면 서로 다른 요소가 바뀌더라도 나머지 요소의 변경 기록이 바뀔 일은 없다.
</p>
<p>
  이렇게 분리할 게 하나 더 있었는데, 마크다운을 html로 변환하는 마크다운 파서가 그것이다. 외부 라이브러리를 쓰지 않고 직접 구현하기로 한 후로, 블로그 생성기 소스 안에 마크다운 파싱 로직을 같이 뒀다. 하지만 시간이 지나면서 이 로직은 점점 커졌고, 따로 빼지 않고는 도저히 못 봐줄 상황에 이르게 되었다. 루비에서 제공하는 gem이라는 패키징 시스템을 써서, 기존 파싱 로직을 별도의 gem으로 분리했다. 이렇게 분리한 뒤에는 마크다운 파서가 변경되더라도 블로그 생성기 쪽에선 마크다운 파서의 gem 버전 변경 기록만 생긴다.
</p>
<h2> xxx</h2>
<p>
  jekyll의 초기 버전을 둘러보다가 jekyll의 저자인 Tom Preston Warner가 왜 jekyll을 만들었는지 알게 되었다. 저자는 기존에 블로그를 만드는 도구가 불편해서 새로운 도구를 만들기 시작했다. jekyll의 가장 첫 버전은 지금과 비교하면 그다지 복잡하지 않았다. 자신에게 필요하고 여겨지는 최소한의 기능만 구현했기 때문이다.
</p>
<p>
  나도 내가 필요한 만큼의 도구를 만들고 싶어서 시작했지만, 생각했던 것만큼 쉬운 일이 아니었다. 하지만 자신만의 도구를 만드는 것, 그것의 복잡도를 이해하고 다룰 수 있게 되는 것, 불편을 해소하는 건 그 어려움을 감내할 만큼 재미있는 과정이었다.
</p>
<h2> 참고 문서</h2>
<ul>
  <li>Tom Preston Warner의 Blogging Like a Hacker</li>
</ul>
<p>
   https://tom.preston-werner.com/2008/11/17/blogging-like-a-hacker<br>- jekyll의 초기 버전 소스<br> https://github.com/jekyll/jekyll/tree/9ff7aa3c57916f04ea42e5bfcf384ce3b1ca2c03<br>- 내가 만든 블로그 생성기 소스<br> https://github.com/rogarithm/autoblog<br>- 내가 만든 마크다운 파서 소스<br> https://github.com/rogarithm/md2html
</p>

		</div>
	</body>
</html>
