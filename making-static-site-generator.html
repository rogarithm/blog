<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="./css/main.css" type="text/css" media="screen" />
	</head>
	<body>
		<div class="site">
			<div class="title">
			</div>
			<h2> xxx</h2>
<p>
  1년 전쯤 새로 취업을 준비하면서 나는 jekyll을 써서 기술 블로그를 만들었다. jekyll은 내가 좋아하는 루비 언어로 만들어졌고, 익숙한 커맨드라인 환경에서 작업할 수 있다는 점이 좋았다. 하지만 잊을만하면 라이브러리나 플러그인 호환성 때문에 빌드가 말썽이었다. 낮은 버전의 jekyll을 쓰다보니 생긴 문제였다. 당시는 개인적으로 루비 언어에 관심이 생겼던 때였다. 한글 자료 중 제일 괜찮은 인사이트 출판사의 <프로그래밍 루비>에서는 오래 된 루비 버전만 다루고 있어서, 아쉬운대로 해당 버전의 루비를 썼다. jekyll을 쓰기로 했을 때, 루비 코드를 건드릴 일이 생기면 공부하던 버전의 루비인 게 낫겠다 싶어 jekyll도 낮은 버전을 썼는데 그러다보니 생긴 문제였다. 비슷한 문제와 해결책을 찾을 수 있는 경우는 별 탈 없이 넘어갈 수 있었다. 하지만 그렇게 할 수 없는 건 해결 가능 여부를 모른 채 의존 라이브러리나 소스 레벨까지 파고들면서 원인을 찾는 데 시간을 쏟아야 하곤 했다.
</p>
<p>
  몇 개 안되는 포스팅 후 나는 블로그 운영에 흥미를 잃었다. 글쓰기가 아닌 블로그 관리에 오랜 시간을 들였던 게 이유였을까. 그러다가 다시 글을 쓰고 싶어졌고, 이전과 같은 문제를 다시 겪고 싶지 않았던 나는 방향을 달리 하기로 마음먹었다. 빌드 오류 해결이 아니라 글쓰기에 집중하고 싶었기 때문이다. 나는 jekyll 대신 내가 필요한 만큼의 기능만 제공하는 단순한 블로그 생성기를 직접 만들기로 했다. 내가 감당할 수 있는 복잡도의 소스라면, 어떤 문제가 생겼을 때 그 문제의 원인을 찾아내기도, 해결책을 알아내기도 수월할 것으로 판단했기 때문이다.
</p>
<h2> xxx</h2>
<p>
  나는 jekyll 초기 버전을 기준으로 삼았다. 다른 사람이 짠 소스이다보니 구조를 빠르게 파악하기는 어려웠지만, git 서비스 기업 코파운더가 만든 프로그램임을 증명하듯 커밋이 잘게 쪼개져 있고, 커밋 메시지도 나름 친절하게 적혀있어 변화 과정을 파악하기 수월했기 때문이다.
</p>
<p>
  만들기를 시작할 때만 해도, 어떤 것부터 시작해야 할지 도무지 감이 잡히지 않았다. 우선 jekyll의 저자는 블로그 생성이라는 비즈니스 로직을 어떻게 생각하는지 알아보기로 했다. 이를 위해 커밋 기록을 따라가면서 코드가 어떻게 바뀌었는지, 어떤 객체를 구현했고, 각 객체는 어떤 역할을 맡으며 서로 어떤 메시지를 주고받는지 살펴봤다. 이런 과정을 통해, 블로그 소프트웨어는 어떤 걸 할 수 있어야 하는지 감을 잡을 수 있었다.
</p>
<p>
  소스를 보면서 내가 이해한 블로그 생성기는 이런 식의 구조를 갖고 동작하는 소프트웨어다.
</p>
<ul>
  <li>site 객체는 블로그를 만드는 데 필요한 모든 정보를 가지고 블로그를 만들 줄 알고 있다.</li>
  <li>작성한 블로그 글인 마크다운 파일 각각은 post 객체로 표현된다. post 객체는 자신이 갖고 있는 마크다운 파일을 html 포맷으로 변환할 줄 알고 있다.</li>
  <li>site 객체는 블로그의 인덱스 페이지를 만들고, post 객체에 요청해 결과적으로 만들어질 블로그 글 html 파일을 생성해 내고, css, 폰트 등 블로그의 스타일과 뼈대를 설정할 때 쓰일 정보를 가져와 적용한다.</li>
</ul>
<p>
  블로그 생성기가 어떤 식으로 돌아가는지 이해한 후에도 추가로 구현해야 할 작업이 많이 남아 있었다. 실제로 써먹을 정도로 만들기 위해서는 모든 부품이 짜맞춰져 돌아갈 수 있는 상태로 만들어야 했기 때문이다. 대부분은 jekyll 초기 버전을 참고해 금방 구현했다. html로 변환한 블로그 글에 html 템플릿을 적용할 수 있게 하는 작업, 각 페이지에 스타일, 폰트 적용하는 작업이 그랬다. 반면 직접 만들기로 한 부분도 있다.
</p>
<ul>
  <li>글 게시일, 글 제목과 같은 메타 데이터를 어디에 둘 지 결정하고, 처리할 수 있도록 구현하는 작업. jekyll에선 liquid란 마크업 언어로 메타 데이터를 처리하지만, 나는 그 대신 간단한 포맷을 정하고 문자열 처리만 해서 메타 데이터를 필요한 곳에 넘겨줄 수 있도록 구현했다. 코드 정리와 관련한 고민(해당 로직을 어디에 둘지, 분기문을 어떻게 하면 더 깔끔하게 정리할 수 있을지와 같은)을 제외하면 간단하게 끝낼 수 있는 작업이었다.</li>
  <li>마크다운을 html로 변환하는 파서를 만드는 작업. 마크다운 형식 파일 내용을 쪼개서 의미 있는 단위로 묶고, 각 묶음을 html로 바꿔주는 파서를 만들어야 했다. 블로그 생성기를 만드는 작업 자체보다 오랜 시간이 걸렸다. 생각했던 것보다 어려운 문제였기 때문이다. 기반 이론을 이해하는 것도 그랬지만, 토크나이져, 파서, 코드 생성기라는 세 개의 구성 요소의 관점에서 생각하는 게 어려웠다. 내가 글 쓸 때 필요한 마크다운 문법이 그렇게 많지도 않아서 별 생각 없이 시작했지만 그러면 안됐다.</li>
</ul>
<h2> xxx</h2>
<p>
  블로그 생성기를 개발하는 과정에서, 유지 관리에 용이하도록 나는 다음 세 가지를 썼다.
</p>
<ul>
  <li>버전관리</li>
  <li>각 요소의 독립적인 버전관리를 위해, 각 요소를 다른 디렉토리로 이동</li>
  <li>관련 요소를 심볼릭 링크로 연결</li>
</ul>
<p>
  웹페이지에서 보는 글은 마크다운 포맷으로 편집할 때에 비해 보기 편해서 새로운 시각으로 글을 다시 볼 수 있었다. 그래서 블로그 생성기를 쓸만한 정도로 만든 다음부터는 글을 만들어나가는 과정에 블로그 생성기를 썼다. 먼저 마크다운 포맷으로 글을 쓰고, 블로그 생성기에 이 파일을 넣고 돌려서 해당 글의 웹페이지를 만들어낸 다음, 웹페이지를 읽었다.
</p>
<p>
  글을 다시 읽어보면서 어색한 부분이 있거나 흐름이 잘 안맞는 부분이 보이면 고쳤다. 테스트용 데이터만 가지고 돌려볼 땐 몰랐는데, 어느정도 길이가 있는 마크다운 파일을 파싱해보니 블로그 생성기나 마크다운 파서에 추가할 기능이나 고쳐야할 부분도 발견하게 되었다. 이렇게 프로그램을 실제로 써보니 글과 프로그램을 수정할 일이 늘어나서, 수정된 내용을 <strong>버전 관리</strong>했다.
</p>
<p>
  각 요소가 다른 디렉토리에 담긴 건, 각 구성 요소가 서로 다른 이유로 변경되기 때문이었다. 위에서 말했듯 글과 블로그 생성기는 서로 다른 이유로 변경되기 때문에, 서로 <strong>독립적인 버전 기록</strong>을 갖게 하고 싶었다. 그래서 서로 다른 디렉토리 아래로 <strong>각 구성 요소를 옮겼다</strong>.
</p>
<p>
  여기서 조금 문제가 있다. 블로그 빌드 과정에서 세 요소는 서로 연관된다. 블로그 생성기가 블로그를 만들 때, 원본 파일이 어디에 있는지와 생성한 블로그 파일을 어디에 둬야할지 알아야 하기 때문이다. 만약 두 디렉토리의 위치가 바뀌면, 그에 맞춰 소스도 수정해줘야 한다. 번거롭다. 그렇게 하는 대신, 블로그 생성기 디렉토리 안에 source와 dest란 이름의 <strong>심볼릭 링크</strong>를 뒀다. 두 링크는 각각 마크다운 파일이 저장된 디렉토리와 생성된 블로그 파일이 저장된 디렉토리를 가리킨다. 이렇게 하면, 링크의 이름이 바뀌지만 않는다면, 두 디렉토리의 위치가 변경되더라도 소스가 바뀔 일은 없다.
</p>
<h2> xxx</h2>
<p>
  jekyll의 초기 버전을 둘러보다가 jekyll의 저자인 Tom Preston Warner가 왜 jekyll을 만들었는지 알게 되었다. 저자는 기존에 블로그를 만드는 도구가 불편해서 새로운 도구를 만들기 시작했다. jekyll의 가장 첫 버전은 지금과 비교하면 그다지 복잡하지 않았다. 자신에게 필요하고 여겨지는 최소한의 기능만 구현했기 때문이다.
</p>
<p>
  나도 내가 필요한 만큼의 도구를 만들고 싶어서 시작했지만, 생각했던 것만큼 쉬운 일이 아니었다. 하지만 자신만의 도구를 만드는 것, 그것의 복잡도를 이해하고 다룰 수 있게 되는 것, 불편을 해소하는 건 그 어려움을 감내할 만큼 재미있는 과정이었다.
</p>
<h2> 참고 문서</h2>
<p>
  - <a href="https://tom.preston-werner.com/2008/11/17/blogging-like-a-hacker">Tom Preston Warner의 Blogging Like a Hacker<a><br>- <a href="https://github.com/jekyll/jekyll/tree/9ff7aa3c57916f04ea42e5bfcf384ce3b1ca2c03">jekyll의 초기 버전 소스</a><br>- <a href="https://github.com/rogarithm/autoblog">내가 만든 블로그 생성기 소스</a><br>- <a href="https://github.com/rogarithm/md2html">내가 만든 마크다운 파서 소스</a>
</p>

		</div>
	</body>
</html>
